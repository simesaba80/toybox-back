# ToybBox Backend Design Doc

## 著者

- simesaba80

## 開発者

- simesaba80
- Taku2515

## 目次

1. [目標](#目標としないもの)
2. [目標としないもの](#目標としないもの)
3. [背景](#背景)
4. [システム概要](#システム概要)
5. [アーキテクチャ設計](#アーキテクチャ設計)
6. [データベース](#データベース)
7. [セキュリティ](#セキュリティ)
8. [運用方針](#運用方針)
9. [代替案の検討](#代替案の検討)
10. [更新履歴](#更新履歴)

# 目標

C3 部員向けの作品投稿プラットフォーム、ToyBox のバックエンドを作成しなおす。  
データベースに保存されたデータのみ引き継ぎ、それ以外は 1 からの開発となる。
リクエストやレスポンスの形式は変更して構わない。

# 目標としないもの

- ブログの投稿プラットフォームとしての機能
  - ブログの投稿プラットフォームは別のシステムとして提供する予定である。そのためこのバックエンドは作品の取り扱いのみに集中する。

# 背景

このバックエンドのプロジェクトは前身となるバックエンドが既に作成されています。以下がリポジトリの URL です。
https://github.com/Kyutech-C3/toybox-server
前バックエンドは FastAPI で書かれていて、作品投稿プラットフォームおよびブログ投稿プラットフォームとしての機能を提供していました。  
しかし現 C3 部員に FastAPI が得意な人がほぼ残っていないこと、当時の初期設計よりもコードが肥大化したことや、まだバグが多く残っている中での主要な開発メンバーの卒業のために主に保守性の面で大きな困難を抱えています。  
そのため現 C3 部員で扱える人が多い Go を使い、保守性を重視したクリーンアーキテクチャを採用しつつ再開発を進めています

## 参考 URL

[前 ToyBox バックエンド](https://github.com/Kyutech-C3/toybox-server)
[前 ToyBox フロントエンド](https://github.com/Kyutech-C3/ToyBox-frontend)
[現 ToyBox バックエンド](https://github.com/simesaba80/toybox-back)
[現 ToyBox フロントエンド](https://github.com/simesaba80/toybox-front)

# システム概要

このシステムは以下のようなアーキテクチャで提供されます。
![toyboxtech.dwawio.png]
バックエンドでは開発言語として Go、Web フレームワークとして Echo、ORM として Bun を採用しています。
また開発を補助する CLI ツールとして以下のものを採用しています。
DI を担当する wire、マイグレーションを行う golang-migrate、Swagger 生成用の swag
これらの技術の選定基準は以下の通りです。

- 後方互換性が担保されているか、破壊的変更の頻度が少ないか
- 技術の習得難度が高すぎないか
- 調べる上で情報を見つけやすいか
- 言語以外の技術は簡単に扱うためのラッパーとして機能してくれるか

採用されていない類似技術については[代替案の検討](#代替案の検討)を参照してください

# アーキテクチャ設計

このプロジェクトでは前 ToyBox バックエンドの反省から長期開発する上で保守性を確保するため、クリーンアーキテクチャを採用しています。  
4 層からなるクリーンアーキテクチャとなっており、以下の 4 層に分かれています。

- ドメイン層
- ユースケース層
- インターフェース層
- インフラストラクチャー層

## ドメイン層

このバックエンドが扱うドメインについて記述します。DB に保存されている情報と等価ではないことに注意してください。

# データベース

# セキュリティ

# 運用方針

# 代替案の検討

# 更新履歴
